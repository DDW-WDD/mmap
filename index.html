<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport"
        content="width=device-width,
        initial-scale=1,minimum-scale=1,
        maximum-scale=1,user-scalable=no"/>
    <title>æ™ºæ…§åŸå¸‚</title>
    <link rel="stylesheet" href="/style.css" type="text/css"/>
     <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ™ï¸</text></svg>">
</head>
<body>
    <div id="app">
            <div class="header">
                <img class="logo" src="/water_face.png" alt="">
            </div>
            <div class="page-container" ref="'container">
                <div class="model-container">
                    <!-- ç§»é™¤åŠ è½½æç¤ºå’Œè¿›åº¦æ¡ -->
                    <div id="canvas" class="canvas">
                    </div>
                    <div id="all-charts" class="all-charts">
                        <div class="section-one">
                            <!-- <img class="img-header" src="/water_face.png" alt=""> -->
                            <div class="section-title-main">æ˜¾è‘—æˆå°±</div>
                            <div class="section-item">
                                <span class="section-title">è„±è´«äººå£</span>
                                <span id="poverty-population" class="section-number">0</span>
                                <span class="section-unit">äºº</span>
                            </div>
                            <div class="section-item">
                                <span class="section-title">è´«å›°é™å¹…</span>
                                <span id="reduction-rate" class="section-number">0</span>
                                <span class="section-unit">%</span>
                            </div>
                            <div class="section-item">
                                <span class="section-title">äººå‡å¯æ”¯é…æ”¶å…¥</span>
                                <span id="disposable-income" class="section-number">0</span>
                                <span class="section-unit">å…ƒ</span>
                            </div>
                            <div class="section-item">
                                <span class="section-title">æ¶ˆé™¤è´«å›°æ‘</span>
                                <span id="eliminated-villages" class="section-number">0</span>
                                <span class="section-unit">ä¸ª</span>
                            </div>
                        </div>
                        <div class="section-two">
                            <!-- <img class="img-header" src="/water_face.png" alt=""> -->
                            <div id="bar-chart"></div>
                        </div>
                        <div class="section-three">
                            <!-- <img class="img-header" src="/water_face.png" alt=""> -->
                            <div id="pie-chart"></div>
                        </div>
                    </div>

                     <div id="right-btns" class="right-btns" style="pointer-events: all;">
                <div id="mode-topView" class="mode-btn" title="é¡¶è§†å›¾">é¡¶è§†</div>
            </div>
                </div>
            </div>
    </div>
    <!-- è¿™äº›å…ƒç´ å°†ç”±BuildInfo.jsåŠ¨æ€åˆ›å»ºå’Œç®¡ç† -->
    <div id="tag-1" class="building-name"></div>
    <div id="tag-2" class="building-info"></div>
<div id="tag-3"
class="building-fire"
style="display: none;">
    <div>ç€ç«å¤§æ¥¼ï¼šä¸œæ–¹æ˜ç </div>
    <div>ç€ç«æ¥¼å±‚ï¼š30å±‚</div>
    <div>ç–æ•£äººç¾¤ï¼š1800äºº</div>
</div>

    <!-- jsdelivr è·¯å¾„æ›´ç¨³å®šï¼ŒåŒæ ·å¸¦å›ºå®šç‰ˆæœ¬ -->
    <!-- <script type="module">
    import * as fflate from 'https://cdn.skypack.dev/fflate@0.8.2?min';
    </script> -->
    <!-- å¿…é¡»ä¿ç•™è¿™è¡ŒCDNå¼•å…¥ï¼Œå¦åˆ™FBXLoaderä»ä¼šæŠ¥fflateæœªå®šä¹‰ -->
    <script src="https://fastly.jsdelivr.net/npm/three@0.8.2/dist/fflate.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/FBXLoader.js"></script>

     <!-- å…³é”®ï¼šSkypack CDN å…¨å±€å¼•å…¥fflate@0.8.2ï¼ŒæŒ‚è½½åˆ°window.fflate -->
    <!-- å¼•å…¥ fflate -->
    <script src="https://fastly.jsdelivr.net/npm/fflate@0.8.2/umd/index.js"></script>
    <!-- å¼•å…¥Three.jsåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>
    <!-- å¼•å…¥dat.guiåº“ -->
    <!-- <script src="https://unpkg.com/dat.gui@0.7.7/build/dat.gui.min.js"></script> -->
    <!-- å¼•å…¥CSS2DRenderer -->
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/renderers/CSS2DRenderer.js"></script>
    <!-- å¼•å…¥æ¨¡å‹åŠ è½½å™¨ -->
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/FBXLoader.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- å¼•å…¥æ°´æ•ˆæœ -->
    <script src="https://fastly.jsdelivr.net/npm/three@0.134.0/examples/js/objects/Water.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <!-- åŸºç¡€æ ¸å¿ƒç±» -->
<script src="BaseModel.js"></script>
<script src="EventBus.js"></script>
<script src="EffectManager.js"></script>
<script src="ClickHandler.js"></script>

<!-- å·¥å…·ç±» -->
<script src="sky.js"></script>
<script src="EagesLine.js"></script>
<script src="getBoxcenter.js"></script>
<script src="loadManager.js"></script>
<script src="utils.js"></script>

<!-- ç»„ä»¶ç±» -->
<script src="BuildInfo.js"></script>
<!-- å–æ¶ˆæ³¨é‡Šç«ç¾ç›¸å…³è„šæœ¬ -->
<script src="Fire.js"></script>
<script src="FireBall.js"></script>
<script src="CityWater.js"></script>
<script src="City.js"></script>
<script src="ship.js"></script>
<script src="Fly.js"></script>
<script src="FreeCameraController.js"></script>

<!-- æ•°æ®å’Œç®¡ç†ç±» -->
<script src="datamanager.js"></script>
<script src="table.js"></script>
<script src="menu.js"></script>

        <!-- æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
        <div id="modeToggle" class="mode-toggle">
            <button id="topViewBtn" class="top-view-btn">é¡¶è§†ç¯ç»•</button>
            <button id="resetViewBtn" class="reset-view-btn">é‡ç½®è§†è§’</button>
        </div>
        
        <!-- äº‹ä»¶ç›‘å¬é€»è¾‘ -->
        <script>
            // ç­‰å¾…DOMåŠ è½½å®Œæˆ
            document.addEventListener('DOMContentLoaded', function() {
                // è·å–é¡¶è§†æŒ‰é’®å…ƒç´ 
                const topViewBtn = document.getElementById('topViewBtn');
                const resetViewBtn = document.getElementById('resetViewBtn');
                
                if (topViewBtn) {
                    // é¡¶è§†æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                    topViewBtn.addEventListener('click', function() {
                        console.log('é¡¶è§†æŒ‰é’®è¢«ç‚¹å‡»');
                        
                        // æ£€æŸ¥æ˜¯å¦å·²ç»æš´éœ²äº†switchViewModeå‡½æ•°
                        if (window.switchViewMode) {
                            // åˆ‡æ¢åˆ°é¡¶è§†æ¨¡å¼
                            window.switchViewMode('topView');
                            
                            // æ›´æ–°æŒ‰é’®æ ·å¼è¡¨ç¤ºå½“å‰çŠ¶æ€
                            topViewBtn.classList.add('active');
                            
                            // å»¶è¿Ÿä¸€ä¸‹ï¼Œç¡®ä¿åˆ‡æ¢ç”Ÿæ•ˆ
                            setTimeout(() => {
                                console.log('é¡¶è§†æ¨¡å¼å·²æ¿€æ´»');
                            }, 100);
                        } else {
                            console.error('switchViewModeå‡½æ•°æœªæ‰¾åˆ°');
                        }
                    });
                }
                
                if (resetViewBtn) {
                    // é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                    resetViewBtn.addEventListener('click', function() {
                        console.log('é‡ç½®è§†è§’æŒ‰é’®è¢«ç‚¹å‡»');
                        
                        // åˆ‡æ¢å›è‡ªç”±æ¨¡å¼
                        if (window.switchViewMode) {
                            window.switchViewMode('free');
                        }
                        
                        // é‡ç½®ç›¸æœºä½ç½®
                        if (window.freeCameraController) {
                            window.freeCameraController.reset();
                        }
                        
                        // æ›´æ–°æŒ‰é’®æ ·å¼
                        const topViewBtn = document.getElementById('topViewBtn');
                        if (topViewBtn) {
                            topViewBtn.classList.remove('active');
                        }
                    });
                }
                
                // ç›‘å¬é”®ç›˜äº‹ä»¶ï¼Œæä¾›å¿«æ·é”®æ”¯æŒ
                document.addEventListener('keydown', function(event) {
                    // Fé”®åˆ‡æ¢é¡¶è§†æ¨¡å¼
                    if (event.key === 'f' || event.key === 'F') {
                        event.preventDefault();
                        if (window.switchViewMode) {
                            // å¦‚æœå½“å‰æ˜¯é¡¶è§†æ¨¡å¼ï¼Œåˆ™åˆ‡æ¢åˆ°è‡ªç”±æ¨¡å¼
                            if (window.currentViewMode === 'topView') {
                                window.switchViewMode('free');
                                const topViewBtn = document.getElementById('topViewBtn');
                                if (topViewBtn) {
                                    topViewBtn.classList.remove('active');
                                }
                            } else {
                                // å¦åˆ™åˆ‡æ¢åˆ°é¡¶è§†æ¨¡å¼
                                window.switchViewMode('topView');
                                const topViewBtn = document.getElementById('topViewBtn');
                                if (topViewBtn) {
                                    topViewBtn.classList.add('active');
                                }
                            }
                        }
                    }
                    
                    // Ré”®é‡ç½®è§†è§’
                    if (event.key === 'r' || event.key === 'R') {
                        event.preventDefault();
                        if (window.freeCameraController) {
                            window.freeCameraController.reset();
                        }
                        if (window.switchViewMode) {
                            window.switchViewMode('free');
                        }
                        const topViewBtn = document.getElementById('topViewBtn');
                        if (topViewBtn) {
                            topViewBtn.classList.remove('active');
                        }
                    }
                });
            });
        </script>

    <!-- æœ€ååŠ è½½å…¥å£æ–‡ä»¶ -->
    <script src="index.js"></script>
</body>
</html>